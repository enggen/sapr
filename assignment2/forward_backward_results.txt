============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.3.3, pluggy-1.5.0
rootdir: /Users/frankcholula/Workspace/school/sapr/assignment2
configfile: pyproject.toml
collected 3 items

tests/test_foward_backward.py::test_emission_matrix 
First Frame Log Probabilities:
[-62.84883983 -62.84883983 -62.84883983 -62.84883983 -62.84883983
 -62.84883983 -62.84883983 -62.84883983]

Emission Matrix:
      State 1     State 2     State 3  ...     State 8     State 9  State 10
T 1      -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 2      -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 3      -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 4      -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 5      -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 6      -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 7      -inf  -64.126868  -64.126868  ...  -64.126868  -64.126868      -inf
T 8      -inf  -41.637723  -41.637723  ...  -41.637723  -41.637723      -inf
T 9      -inf  -71.792627  -71.792627  ...  -71.792627  -71.792627      -inf
T 10     -inf  -87.817928  -87.817928  ...  -87.817928  -87.817928      -inf
T 11     -inf  -92.512529  -92.512529  ...  -92.512529  -92.512529      -inf
T 12     -inf  -95.685708  -95.685708  ...  -95.685708  -95.685708      -inf
T 13     -inf -147.665691 -147.665691  ... -147.665691 -147.665691      -inf
T 14     -inf -161.027497 -161.027497  ... -161.027497 -161.027497      -inf
T 15     -inf -159.590043 -159.590043  ... -159.590043 -159.590043      -inf
T 16     -inf -156.548695 -156.548695  ... -156.548695 -156.548695      -inf
T 17     -inf -154.721287 -154.721287  ... -154.721287 -154.721287      -inf
T 18     -inf -154.792315 -154.792315  ... -154.792315 -154.792315      -inf
T 19     -inf -164.340076 -164.340076  ... -164.340076 -164.340076      -inf
T 20     -inf -170.713414 -170.713414  ... -170.713414 -170.713414      -inf
T 21     -inf -160.266799 -160.266799  ... -160.266799 -160.266799      -inf
T 22     -inf -168.409910 -168.409910  ... -168.409910 -168.409910      -inf
T 23     -inf -179.273819 -179.273819  ... -179.273819 -179.273819      -inf
T 24     -inf -192.490538 -192.490538  ... -192.490538 -192.490538      -inf
T 25     -inf -196.707260 -196.707260  ... -196.707260 -196.707260      -inf
T 26     -inf -191.177063 -191.177063  ... -191.177063 -191.177063      -inf
T 27     -inf -206.732173 -206.732173  ... -206.732173 -206.732173      -inf
T 28     -inf -203.702589 -203.702589  ... -203.702589 -203.702589      -inf
T 29     -inf -200.293770 -200.293770  ... -200.293770 -200.293770      -inf
T 30     -inf -177.518944 -177.518944  ... -177.518944 -177.518944      -inf
T 31     -inf -141.293271 -141.293271  ... -141.293271 -141.293271      -inf
T 32     -inf -114.957931 -114.957931  ... -114.957931 -114.957931      -inf
T 33     -inf  -89.634657  -89.634657  ...  -89.634657  -89.634657      -inf
T 34     -inf  -55.263542  -55.263542  ...  -55.263542  -55.263542      -inf
T 35     -inf  -63.415939  -63.415939  ...  -63.415939  -63.415939      -inf
T 36     -inf  -68.680085  -68.680085  ...  -68.680085  -68.680085      -inf
T 37     -inf  -46.592594  -46.592594  ...  -46.592594  -46.592594      -inf
T 38     -inf  -57.587096  -57.587096  ...  -57.587096  -57.587096      -inf
T 39     -inf  -49.774339  -49.774339  ...  -49.774339  -49.774339      -inf
T 40     -inf  -53.855644  -53.855644  ...  -53.855644  -53.855644      -inf
T 41     -inf  -25.702370  -25.702370  ...  -25.702370  -25.702370      -inf
T 42     -inf  -76.568170  -76.568170  ...  -76.568170  -76.568170      -inf
T 43     -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 44     -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 45     -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 46     -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf
T 47     -inf  -62.848840  -62.848840  ...  -62.848840  -62.848840      -inf

[47 rows x 10 columns]
PASSED
tests/test_foward_backward.py::test_fb_probabilities_basic 
Forward Probabilities (Alpha):

Alpha Matrix:
      State 0      State 1      State 2  ...      State 7      State 8      State 9
T 0       0.0   -62.848840         -inf  ...         -inf         -inf         -inf
T 1      -inf   -62.848840  -127.525312  ...         -inf         -inf         -inf
T 2      -inf  -125.872978  -127.525312  ...         -inf         -inf         -inf
T 3      -inf  -188.897117  -189.856304  ...         -inf         -inf         -inf
T 4      -inf  -251.921256  -252.474977  ...         -inf         -inf         -inf
T 5      -inf  -314.945394  -315.211434  ...         -inf         -inf         -inf
T 6      -inf  -379.247561  -379.290457  ...  -452.185702         -inf         -inf
T 7      -inf  -421.060582  -420.921157  ...  -430.974585  -495.651058         -inf
T 8      -inf  -493.028508  -492.734932  ...  -500.996601  -504.594845  -497.478690
T 9      -inf  -581.021735  -580.594627  ...  -587.603533  -590.508630  -506.422478
T 10     -inf  -673.709563  -673.164672  ...  -679.192749  -681.692381  -592.336263
T 11     -inf  -769.570570  -768.920319  ...  -774.137466  -776.349415  -683.520014
T 12     -inf  -917.411561  -916.665999  ...  -921.189999  -923.178805  -778.177048
T 13     -inf -1078.614357 -1077.781784  ... -1081.699648 -1083.506132  -925.006437
T 14     -inf -1238.379699 -1237.467083  ... -1240.845951 -1242.498284 -1085.333765
T 15     -inf -1395.103693 -1394.116970  ... -1397.010329 -1398.529131 -1244.325917
T 16     -inf -1550.000279 -1548.944562  ... -1551.396089 -1552.797108 -1400.356764
T 17     -inf -1704.967892 -1703.847637  ... -1705.893699 -1707.189357 -1554.624741
T 18     -inf -1869.483267 -1868.302388  ... -1869.973756 -1871.174104 -1709.016990
T 19     -inf -2040.371980 -2039.133942  ... -2040.457004 -2041.570341 -1873.001737
T 20     -inf -2200.814078 -2199.521973  ... -2200.519612 -2201.552907 -2043.397974
T 21     -inf -2369.399287 -2368.055888  ... -2368.748146 -2369.707332 -2203.380539
T 22     -inf -2548.848405 -2547.456216  ... -2547.860791 -2548.750985 -2371.534965
T 23     -inf -2741.514242 -2740.075533  ... -2740.208175 -2741.033830 -2550.578618
T 24     -inf -2938.396800 -2936.913640  ... -2936.788453 -2937.553483 -2742.861463
T 25     -inf -3129.749163 -3128.223443  ... -3127.853133 -3128.561005 -2939.381116
T 26     -inf -3336.656634 -3335.090092  ... -3334.486167 -3335.139972 -3130.388637
T 27     -inf -3540.534522 -3538.928759  ... -3538.101691 -3538.704202 -3336.967605
T 28     -inf -3741.003590 -3739.360087  ... -3738.319444 -3738.873166 -3540.531835
T 29     -inf -3918.697833 -3917.017962  ... -3915.772526 -3916.279727 -3740.700799
T 30     -inf -4060.166403 -4058.451441  ... -4057.009293 -4057.472043 -3918.107360
T 31     -inf -4175.299632 -4173.550769  ... -4171.919379 -4172.339570 -4059.299676
T 32     -inf -4265.109588 -4263.327934  ... -4261.514224 -4261.893592 -4174.167202
T 33     -inf -4320.548428 -4318.735026  ... -4316.745425 -4317.085572 -4263.721224
T 34     -inf -4384.139666 -4382.295492  ... -4380.135992 -4380.438399 -4318.913205
T 35     -inf -4452.995050 -4451.121024  ... -4448.797220 -4449.063260 -4382.266032
T 36     -inf -4499.762944 -4497.859929  ... -4495.377061 -4495.608009 -4450.890892
T 37     -inf -4557.525339 -4555.594154  ... -4552.957135 -4553.154181 -4497.435642
T 38     -inf -4607.474976 -4605.516392  ... -4602.729842 -4602.894098 -4554.981814
T 39     -inf -4661.505919 -4659.520667  ... -4656.588934 -4656.721442 -4604.721731
T 40     -inf -4687.383588 -4685.372360  ... -4682.299549 -4682.401285 -4658.549075
T 41     -inf -4764.127056 -4762.090511  ... -4758.880498 -4758.952382 -4684.228918
T 42     -inf -4827.151195 -4825.089957  ... -4821.746413 -4821.789309 -4760.780015
T 43     -inf -4890.175334 -4888.089998  ... -4884.616401 -4884.631126 -4823.616942
T 44     -inf -4953.199472 -4951.090606  ... -4947.490258 -4947.477584 -4886.458759
T 45     -inf -5016.223611 -5014.091755  ... -5010.367793 -5010.328450 -4949.305216
T 46     -inf -5079.247750 -5077.093421  ... -5073.248830 -5073.183513 -5012.156083

[47 rows x 10 columns]

Backward Probabilities (Beta):

Beta Matrix:
          State 0      State 1      State 2  ...      State 7      State 8  State 9
T 0  -5012.156083 -5012.162306 -5012.227623  ... -5016.072214 -5018.226542     -inf
T 1  -4949.305216 -4949.307243 -4949.346585  ... -4953.070548 -4955.202404     -inf
T 2  -4886.458759 -4886.456376 -4886.469050  ... -4890.069399 -4892.178265     -inf
T 3  -4823.616942 -4823.609919 -4823.595194  ... -4827.068791 -4829.154127     -inf
T 4  -4760.780015 -4760.768102 -4760.725206  ... -4764.068750 -4766.129988     -inf
T 5  -4697.948248 -4697.931175 -4697.859291  ... -4701.069304 -4703.105849     -inf
T 6  -4633.843907 -4633.821380 -4633.719644  ... -4636.792455 -4638.803683     -inf
T 7  -4592.234485 -4592.206184 -4592.073676  ... -4595.005409 -4596.990661     -inf
T 8  -4520.476279 -4520.441857 -4520.277601  ... -4523.064151 -4525.022735     -inf
T 9  -4432.699276 -4432.658351 -4432.461305  ... -4435.098324 -4437.029509     -inf
T 10 -4340.234591 -4340.186746 -4339.955798  ... -4342.438666 -4344.341681     -inf
T 11 -4244.604107 -4244.548883 -4244.282843  ... -4246.606647 -4248.480673     -inf
T 12 -4097.001528 -4096.938416 -4096.636009  ... -4098.795509 -4100.639683     -inf
T 13 -3936.045592 -3935.974031 -3935.633883  ... -3937.623485 -3939.436887     -inf
T 14 -3776.536183 -3776.455549 -3776.076181  ... -3777.889891 -3779.671545     -inf
T 15 -3620.077892 -3619.987488 -3619.567298  ... -3621.198687 -3622.947551     -inf
T 16 -3465.457560 -3465.356606 -3464.893856  ... -3466.336003 -3468.050965     -inf
T 17 -3310.777629 -3310.665246 -3310.158044  ... -3311.403481 -3313.083352     -inf
T 18 -3146.562358 -3146.437552 -3145.883831  ... -3146.924473 -3148.567976     -inf
T 19 -2975.987303 -2975.848944 -2975.246432  ... -2976.073501 -2977.679263     -inf
T 20 -2815.873709 -2815.720504 -2815.066699  ... -2815.670623 -2817.237165     -inf
T 21 -2647.633341 -2647.463799 -2646.755927  ... -2647.126237 -2648.651957     -inf
T 22 -2468.547128 -2468.359522 -2467.594491  ... -2467.719679 -2469.202839     -inf
T 23 -2276.264284 -2276.056590 -2275.230935  ... -2275.098293 -2276.537002     -inf
T 24 -2079.787190 -2079.557024 -2078.666830  ... -2078.262255 -2079.654443     -inf
T 25 -1888.865611 -1888.610127 -1887.650940  ... -1886.958683 -1888.302081     -inf
T 26 -1682.417671 -1682.133438 -1681.100143  ... -1680.102504 -1681.394609     -inf
T 27 -1479.032260 -1478.715083 -1477.601745  ... -1476.278684 -1477.516722     -inf
T 28 -1279.093820 -1278.738491 -1277.538142  ... -1275.866774 -1277.047654     -inf
T 29 -1101.974941 -1101.574876 -1100.279217  ... -1098.233156 -1099.353410     -inf
T 30  -961.134981  -960.681671  -959.280651  ...  -956.829125  -957.884841     -inf
T 31  -846.694898  -846.177050  -844.658247  ...  -841.764888  -842.751611     -inf
T 32  -757.658132  -757.060241  -755.407908  ...  -752.029040  -752.941656     -inf
T 33  -703.094761  -702.394591  -700.588106  ...  -696.670243  -697.502816     -inf
T 34  -640.515124  -639.678822  -637.690016  ...  -633.166016  -633.911577     -inf
T 35  -572.863712  -571.835038  -569.623089  ...  -564.405942  -565.056193     -inf
T 36  -527.599897  -526.271118  -523.771486  ...  -517.743409  -518.288300     -inf
T 37  -471.916943  -470.012800  -467.107703  ...  -460.098797  -460.525905     -inf
T 38         -inf  -422.142604  -418.544360  ...  -410.282691  -410.576267     -inf
T 39         -inf         -inf  -366.459328  ...  -356.405899  -356.545325     -inf
T 40         -inf         -inf         -inf  ...  -330.710552  -330.667656     -inf
T 41         -inf         -inf         -inf  ...  -254.190227  -253.924187     -inf
T 42         -inf         -inf         -inf  ...  -191.453770  -190.900049     -inf
T 43         -inf         -inf         -inf  ...  -128.835097  -127.875910     -inf
T 44         -inf         -inf         -inf  ...   -66.504105   -64.851771     -inf
T 45         -inf         -inf         -inf  ...         -inf    -1.827633     -inf
T 46         -inf         -inf         -inf  ...         -inf         -inf      0.0

[47 rows x 10 columns]

Forward-Backward sums at each timestep:
t=0: -5012.156083116311
t=1: -5012.156083116311
t=2: -5012.156083116311
t=3: -5012.15608311631
t=4: -5012.156083116311
t=5: -5012.156083116311
t=6: -5012.156083116308
t=7: -5012.156083116311
t=8: -5012.156083116311
t=9: -5012.156083116308
t=10: -5012.15608311631
t=11: -5012.15608311631
t=12: -5012.156083116311
t=13: -5012.156083116309
t=14: -5012.156083116309
t=15: -5012.15608311631
t=16: -5012.15608311631
t=17: -5012.15608311631
t=18: -5012.15608311631
t=19: -5012.156083116309
t=20: -5012.156083116309
t=21: -5012.156083116309
t=22: -5012.156083116309
t=23: -5012.156083116309
t=24: -5012.15608311631
t=25: -5012.156083116311
t=26: -5012.156083116311
t=27: -5012.156083116311
t=28: -5012.1560831163115
t=29: -5012.1560831163115
t=30: -5012.156083116311
t=31: -5012.1560831163115
t=32: -5012.1560831163115
t=33: -5012.156083116311
t=34: -5012.156083116311
t=35: -5012.156083116311
t=36: -5012.1560831163115
t=37: -5012.1560831163115
t=38: -5012.1560831163115
t=39: -5012.156083116312
t=40: -5012.156083116312
t=41: -5012.1560831163115
t=42: -5012.156083116313
t=43: -5012.156083116313
t=44: -5012.156083116313
t=45: -5012.156083116313
t=46: -5012.156083116313

Sample log probabilities at t=0:
Alpha[0,0] (entry state): 0.0
Alpha[0,1] (first real state): -62.84883983427769
Beta[0,1] (first real state): -5012.162305591048
PASSED
tests/test_foward_backward.py::test_fb_probabilities_advanced 
At timestep 23
Posterior probabilities: [0.00445046 0.04283564 0.15874384 0.29397007 0.29397007 0.15874384
 0.04283564 0.00445046]
Gamma probabilities: [0.00445046 0.04283564 0.15874384 0.29397007 0.29397007 0.15874384
 0.04283564 0.00445046]
PASSED

============================== 3 passed in 0.43s ===============================
