============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.3.3, pluggy-1.5.0
rootdir: /Users/frankcholula/Workspace/school/sapr/assignment2
configfile: pyproject.toml
collected 6 items

tests/test_training.py::test_gamma_properties 
Gamma probabilities for first 5 time steps:
     State_0  State_1  State_2  State_3  ...  State_6  State_7  State_8  State_9
t=0   1.0000   0.0000   0.0000   0.0000  ...   0.0000   0.0000   0.0000   0.0000
t=1   0.0000   1.0000   0.0000   0.0000  ...   0.0000   0.0000   0.0000   0.0000
t=2   0.0000   0.8409   0.1591   0.0000  ...   0.0000   0.0000   0.0000   0.0000
t=3   0.0000   0.7040   0.2738   0.0222  ...   0.0000   0.0000   0.0000   0.0000
t=4   0.0000   0.5867   0.3520   0.0587  ...   0.0000   0.0000   0.0000   0.0000

[5 rows x 10 columns]

Sum of probabilities at each time step (should be close to 1):
t=0: 1.000000
t=1: 1.000000
t=2: 1.000000
t=3: 1.000000
t=4: 1.000000

First time step probabilities:
[1.00000000e+00 5.03956765e-28 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00]

Active states (prob > 0.01) at different time points:
t=0: states [0] active
t=11: states [1 2 3 4 5] active
t=23: states [2 3 4 5 6 7] active
t=35: states [4 5 6 7 8] active
t=46: states [9] active
PASSED
tests/test_training.py::test_xi_debug 
Xi calculation components for t=1, state 1->1:
alpha[t,i]: -62.84883983427769
beta[t+1,j]: -4886.456376364248
A[i,j]: 0.8392062244694939
emission[t+1,j]: -62.84883983427769
log_likelihood: -5012.156083116313

Calculated xi value: 0.8409090909118178
Actual xi value from method: 0.8409090909091734

Xi values at t=1 for possible transitions:
         To_0   To_1   To_2   To_3   To_4   To_5   To_6   To_7   To_8   To_9
From_0 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_1 0.0000 0.8409 0.1591 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_2 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_3 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_4 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_5 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_6 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_7 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_8 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
From_9 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
PASSED
tests/test_training.py::test_gamma_xi_probabilities 
Gamma Matrix:

Gamma Matrix:
      State 0  State 1  State 2  State 3  ...  State 6  State 7  State 8  State 9
T 0    1.0000   0.0000   0.0000   0.0000  ...   0.0000   0.0000   0.0000   0.0000
T 1    0.0000   1.0000   0.0000   0.0000  ...   0.0000   0.0000   0.0000   0.0000
T 2    0.0000   0.8409   0.1591   0.0000  ...   0.0000   0.0000   0.0000   0.0000
T 3    0.0000   0.7040   0.2738   0.0222  ...   0.0000   0.0000   0.0000   0.0000
T 4    0.0000   0.5867   0.3520   0.0587  ...   0.0000   0.0000   0.0000   0.0000
T 5    0.0000   0.4865   0.4007   0.1030  ...   0.0000   0.0000   0.0000   0.0000
T 6    0.0000   0.4014   0.4257   0.1502  ...   0.0000   0.0000   0.0000   0.0000
T 7    0.0000   0.3293   0.4323   0.1965  ...   0.0001   0.0000   0.0000   0.0000
T 8    0.0000   0.2687   0.4247   0.2389  ...   0.0004   0.0000   0.0000   0.0000
T 9    0.0000   0.2178   0.4066   0.2755  ...   0.0009   0.0000   0.0000   0.0000
T 10   0.0000   0.1755   0.3812   0.3050  ...   0.0020   0.0001   0.0000   0.0000
T 11   0.0000   0.1404   0.3510   0.3268  ...   0.0037   0.0002   0.0000   0.0000
T 12   0.0000   0.1115   0.3179   0.3406  ...   0.0064   0.0004   0.0000   0.0000
T 13   0.0000   0.0878   0.2838   0.3468  ...   0.0103   0.0008   0.0000   0.0000
T 14   0.0000   0.0686   0.2498   0.3458  ...   0.0156   0.0014   0.0000   0.0000
T 15   0.0000   0.0531   0.2169   0.3384  ...   0.0227   0.0024   0.0001   0.0000
T 16   0.0000   0.0407   0.1859   0.3254  ...   0.0318   0.0038   0.0002   0.0000
T 17   0.0000   0.0309   0.1573   0.3078  ...   0.0431   0.0059   0.0003   0.0000
T 18   0.0000   0.0232   0.1313   0.2865  ...   0.0567   0.0087   0.0005   0.0000
T 19   0.0000   0.0172   0.1081   0.2626  ...   0.0727   0.0126   0.0008   0.0000
T 20   0.0000   0.0125   0.0878   0.2371  ...   0.0910   0.0177   0.0013   0.0000
T 21   0.0000   0.0090   0.0702   0.2107  ...   0.1117   0.0243   0.0020   0.0000
T 22   0.0000   0.0064   0.0553   0.1844  ...   0.1343   0.0326   0.0030   0.0000
T 23   0.0000   0.0045   0.0428   0.1587  ...   0.1587   0.0428   0.0045   0.0000
T 24   0.0000   0.0030   0.0326   0.1343  ...   0.1844   0.0553   0.0064   0.0000
T 25   0.0000   0.0020   0.0243   0.1117  ...   0.2107   0.0702   0.0090   0.0000
T 26   0.0000   0.0013   0.0177   0.0910  ...   0.2371   0.0878   0.0125   0.0000
T 27   0.0000   0.0008   0.0126   0.0727  ...   0.2626   0.1081   0.0172   0.0000
T 28   0.0000   0.0005   0.0087   0.0567  ...   0.2865   0.1313   0.0232   0.0000
T 29   0.0000   0.0003   0.0059   0.0431  ...   0.3078   0.1573   0.0309   0.0000
T 30   0.0000   0.0002   0.0038   0.0318  ...   0.3254   0.1859   0.0407   0.0000
T 31   0.0000   0.0001   0.0024   0.0227  ...   0.3384   0.2169   0.0531   0.0000
T 32   0.0000   0.0000   0.0014   0.0156  ...   0.3458   0.2498   0.0686   0.0000
T 33   0.0000   0.0000   0.0008   0.0103  ...   0.3468   0.2838   0.0878   0.0000
T 34   0.0000   0.0000   0.0004   0.0064  ...   0.3406   0.3179   0.1115   0.0000
T 35   0.0000   0.0000   0.0002   0.0037  ...   0.3268   0.3510   0.1404   0.0000
T 36   0.0000   0.0000   0.0001   0.0020  ...   0.3050   0.3812   0.1755   0.0000
T 37   0.0000   0.0000   0.0000   0.0009  ...   0.2755   0.4066   0.2178   0.0000
T 38   0.0000   0.0000   0.0000   0.0004  ...   0.2389   0.4247   0.2687   0.0000
T 39   0.0000   0.0000   0.0000   0.0001  ...   0.1965   0.4323   0.3293   0.0000
T 40   0.0000   0.0000   0.0000   0.0000  ...   0.1502   0.4257   0.4014   0.0000
T 41   0.0000   0.0000   0.0000   0.0000  ...   0.1030   0.4007   0.4865   0.0000
T 42   0.0000   0.0000   0.0000   0.0000  ...   0.0587   0.3520   0.5867   0.0000
T 43   0.0000   0.0000   0.0000   0.0000  ...   0.0222   0.2738   0.7040   0.0000
T 44   0.0000   0.0000   0.0000   0.0000  ...   0.0000   0.1591   0.8409   0.0000
T 45   0.0000   0.0000   0.0000   0.0000  ...   0.0000   0.0000   1.0000   0.0000
T 46   0.0000   0.0000   0.0000   0.0000  ...   0.0000   0.0000   0.0000   1.0000

[47 rows x 10 columns]

Xi Matrix for t=10 (transitions from time step 10):

Xi Matrix t=10:
              To State 0  To State 1  ...  To State 8  To State 9
From State 0      0.0000      0.0000  ...      0.0000      0.0000
From State 1      0.0000      0.1404  ...      0.0000      0.0000
From State 2      0.0000      0.0000  ...      0.0000      0.0000
From State 3      0.0000      0.0000  ...      0.0000      0.0000
From State 4      0.0000      0.0000  ...      0.0000      0.0000
From State 5      0.0000      0.0000  ...      0.0000      0.0000
From State 6      0.0000      0.0000  ...      0.0000      0.0000
From State 7      0.0000      0.0000  ...      0.0000      0.0000
From State 8      0.0000      0.0000  ...      0.0000      0.0000
From State 9      0.0000      0.0000  ...      0.0000      0.0000

[10 rows x 10 columns]
PASSED
tests/test_training.py::test_update_transitions 
Diagnostic Information:
Aggregated gamma shape: (10,)
Aggregated xi shape: (10, 10)

Aggregated gamma sums per state:
State 0: 28.280592
State 1: 202.839926
State 2: 202.839926
State 3: 202.839926
State 4: 202.839926
State 5: 202.839926
State 6: 202.839926
State 7: 202.839926
State 8: 202.839926
State 9: 0.000000

Xi transition sums for first real state (state 1):
Sum of transitions from state 1: 202.839926
Self-loop (1->1): 172.839926
Forward (1->2): 30.000000

Initial A matrix:

Initial Transition Matrix:
           T 0    T 1    T 2    T 3    T 4    T 5    T 6    T 7    T 8    T 9
State 0 0.0000 1.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
State 1 0.0000 0.8392 0.1608 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
State 2 0.0000 0.0000 0.8392 0.1608 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
State 3 0.0000 0.0000 0.0000 0.8392 0.1608 0.0000 0.0000 0.0000 0.0000 0.0000
State 4 0.0000 0.0000 0.0000 0.0000 0.8392 0.1608 0.0000 0.0000 0.0000 0.0000
State 5 0.0000 0.0000 0.0000 0.0000 0.0000 0.8392 0.1608 0.0000 0.0000 0.0000
State 6 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.8392 0.1608 0.0000 0.0000
State 7 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.8392 0.1608 0.0000
State 8 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.8392 0.1608
State 9 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000

Updated A matrix:

Updated Transition Matrix:
           T 0    T 1    T 2    T 3    T 4    T 5    T 6    T 7    T 8    T 9
State 0 0.0000 1.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
State 1 0.0000 0.8521 0.1479 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
State 2 0.0000 0.0000 0.8521 0.1479 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000
State 3 0.0000 0.0000 0.0000 0.8521 0.1479 0.0000 0.0000 0.0000 0.0000 0.0000
State 4 0.0000 0.0000 0.0000 0.0000 0.8521 0.1479 0.0000 0.0000 0.0000 0.0000
State 5 0.0000 0.0000 0.0000 0.0000 0.0000 0.8521 0.1479 0.0000 0.0000 0.0000
State 6 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.8521 0.1479 0.0000 0.0000
State 7 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.8521 0.1479 0.0000
State 8 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.8521 0.1479
State 9 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000

Row sums of updated transition matrix:
State 0: 1.0000000000
State 1: 1.0000000000
State 2: 1.0000000000
State 3: 1.0000000000
State 4: 1.0000000000
State 5: 1.0000000000
State 6: 1.0000000000
State 7: 1.0000000000
State 8: 1.0000000000
State 9: 1.0000000000

State 1 transitions:
Self-loop (a_11): 0.852100
Forward (a_12): 0.147900
Row sum: 1.0000000000

State 2 transitions:
Self-loop (a_22): 0.852100
Forward (a_23): 0.147900
Row sum: 1.0000000000

State 3 transitions:
Self-loop (a_33): 0.852100
Forward (a_34): 0.147900
Row sum: 1.0000000000

State 4 transitions:
Self-loop (a_44): 0.852100
Forward (a_45): 0.147900
Row sum: 1.0000000000

State 5 transitions:
Self-loop (a_55): 0.852100
Forward (a_56): 0.147900
Row sum: 1.0000000000

State 6 transitions:
Self-loop (a_66): 0.852100
Forward (a_67): 0.147900
Row sum: 1.0000000000

State 7 transitions:
Self-loop (a_77): 0.852100
Forward (a_78): 0.147900
Row sum: 1.0000000000

State 8 transitions:
Self-loop (a_88): 0.852100
Row sum: 1.0000000000
PASSED
tests/test_training.py::test_update_emissions 
Initial Means:
           MFCC 0   MFCC 1   MFCC 2  MFCC 3  ...  MFCC 9  MFCC 10  MFCC 11  MFCC 12
State 0 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 1 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 2 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 3 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 4 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 5 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 6 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 7 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 8 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319
State 9 -338.0058 102.3148 -16.4172 33.0500  ... -2.2195  -0.6454  -8.4113   1.7319

[10 rows x 13 columns]

Initial Covariance Matrices:

State 1 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 2 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 3 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 4 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 5 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 6 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 7 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

State 8 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11  MFCC_12  MFCC_13
MFCC_1  27861.5807    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_2      0.0000 4428.2413   -0.0000  ...  -0.0000  -0.0000  -0.0000
MFCC_3     -0.0000   -0.0000 1204.4603  ...  -0.0000   0.0000  -0.0000
MFCC_4      0.0000    0.0000   -0.0000  ...  -0.0000  -0.0000   0.0000
MFCC_5     -0.0000   -0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_6      0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_7     -0.0000    0.0000    0.0000  ...  -0.0000   0.0000  -0.0000
MFCC_8     -0.0000   -0.0000    0.0000  ...   0.0000  -0.0000   0.0000
MFCC_9     -0.0000   -0.0000    0.0000  ...   0.0000   0.0000   0.0000
MFCC_10    -0.0000   -0.0000   -0.0000  ...   0.0000  -0.0000   0.0000
MFCC_11    -0.0000   -0.0000   -0.0000  ... 108.6182   0.0000   0.0000
MFCC_12    -0.0000   -0.0000    0.0000  ...   0.0000 108.5609   0.0000
MFCC_13     0.0000   -0.0000   -0.0000  ...   0.0000   0.0000  87.9699

[13 rows x 13 columns]

Updated Means:
           MFCC 0   MFCC 1  MFCC 2  MFCC 3  ...  MFCC 9  MFCC 10  MFCC 11  MFCC 12
State 0    0.0000   0.0000  0.0000  0.0000  ...  0.0000   0.0000   0.0000   0.0000
State 1 -468.3693  41.3087 -3.0035 24.2649  ... -1.7781   0.6282  -4.2314   0.9001
State 2 -330.7567  83.2409 -7.6827 58.5799  ... -4.7326  -0.2317 -11.5748   0.6828
State 3 -251.5456 103.2984 -7.7986 81.1482  ... -7.4125  -3.0578 -17.5468  -1.3065
State 4 -229.4145 111.4834 -4.5350 89.1409  ... -8.9843  -4.9160 -19.5607  -3.0591
State 5 -242.3040 112.1647 -1.9919 86.0262  ... -9.3004  -4.0975 -17.7669  -2.6789
State 6 -275.5559 103.6632 -1.6985 74.3000  ... -8.4635  -1.4259 -13.7939   0.0907
State 7 -338.7915  83.9382 -0.9011 54.1349  ... -6.3493   0.8997  -9.2075   2.8180
State 8 -458.4053  45.5677  1.5983 24.8878  ... -2.9914   0.9267  -4.1843   2.2535
State 9    0.0000   0.0000  0.0000  0.0000  ...  0.0000   0.0000   0.0000   0.0000

[10 rows x 13 columns]

Updated Covariance Matrices:

State 1 Covariance:
            MFCC_1    MFCC_2     MFCC_3  ...  MFCC_11   MFCC_12  MFCC_13
MFCC_1  20281.4056 6260.8957 -1061.6817  ...  74.3311 -886.3242 140.0130
MFCC_2   6260.8957 2556.4983  -111.9872  ...  22.5898 -237.8711  32.9686
MFCC_3  -1061.6817 -111.9872   302.5587  ... -35.7473   35.6199 -26.4836
MFCC_4   4588.5940 1315.6233  -243.0702  ...  24.6395 -207.7542  22.6492
MFCC_5  -1044.1962 -198.8655   106.7290  ...  -4.8943   66.5685 -41.3675
MFCC_6    314.8785   97.1097   -23.8617  ...   8.6945   -7.4557  11.5815
MFCC_7   -266.6525  -56.9641    57.8806  ...  -9.5982    5.1563  -1.2388
MFCC_8    557.4543  183.5837   -46.3471  ...  21.6988  -10.4367  -5.8546
MFCC_9   -967.6595 -253.6691    28.7795  ...  10.7379   60.2102   4.3937
MFCC_10  -334.9956 -115.5360     4.4166  ...   3.5910   12.4515  14.8756
MFCC_11    74.3311   22.5898   -35.7473  ...  34.2774   14.6601   2.4221
MFCC_12  -886.3242 -237.8711    35.6199  ...  14.6601   70.7250  -4.9013
MFCC_13   140.0130   32.9686   -26.4836  ...   2.4221   -4.9013  40.9432

[13 rows x 13 columns]

State 2 Covariance:
            MFCC_1    MFCC_2     MFCC_3  ...   MFCC_11    MFCC_12  MFCC_13
MFCC_1  19309.4651 4658.0603 -1029.5701  ... -219.7708 -1136.0536 -70.1948
MFCC_2   4658.0603 1969.8033    41.3955  ...  -57.2586  -225.4293 -41.4502
MFCC_3  -1029.5701   41.3955   536.2644  ...  -55.3328    22.8104 -38.5025
MFCC_4   4655.3858 1039.1308  -211.4854  ...  -38.6768  -278.1750 -39.6012
MFCC_5   -974.5319   31.5311   139.0938  ...    0.8315    97.2022 -75.0331
MFCC_6     82.3888   10.3344    -2.8656  ...   28.9117    12.1000  18.4395
MFCC_7   -312.6711  -29.3361    91.9494  ...  -22.7515     4.2346   4.3690
MFCC_8    290.8294   95.0100   -77.1749  ...   58.4116    19.4390 -21.5223
MFCC_9  -1384.8147 -276.8141     6.7111  ...   53.4224   122.1620  22.2676
MFCC_10  -435.1091 -125.5422     2.0316  ...    5.5590    19.6693  42.3594
MFCC_11  -219.7708  -57.2586   -55.3328  ...   87.1342    48.8246   1.4194
MFCC_12 -1136.0536 -225.4293    22.8104  ...   48.8246   134.3653   4.5439
MFCC_13   -70.1948  -41.4502   -38.5025  ...    1.4194     4.5439  87.1039

[13 rows x 13 columns]

State 3 Covariance:
           MFCC_1    MFCC_2    MFCC_3  ...   MFCC_11   MFCC_12   MFCC_13
MFCC_1  8074.5703 1282.8372 -439.2393  ... -314.3782 -629.0443 -145.9891
MFCC_2  1282.8372  973.0175  220.2728  ...  -83.0733  -78.7796  -67.3469
MFCC_3  -439.2393  220.2728  637.2941  ...  -38.1671   -5.3665  -42.5027
MFCC_4  1819.2515  347.7822  -37.1082  ...  -53.4872 -133.0730  -59.5661
MFCC_5  -379.8948  314.3718   88.9267  ...    2.3470   88.4786  -83.9716
MFCC_6  -126.7146  -55.5929   59.8148  ...   51.1343   26.7074   13.9323
MFCC_7  -153.0314   60.0101   87.0497  ...  -42.8628   -2.0011    6.3841
MFCC_8   -93.2647   -5.3445  -90.3704  ...   93.4216   46.2465  -26.9613
MFCC_9  -789.0340 -109.8603  -26.1505  ...   65.2832  105.5125   17.3265
MFCC_10 -236.8579  -65.2952   -3.4507  ...   -8.4242    8.7289   59.6133
MFCC_11 -314.3782  -83.0733  -38.1671  ...  118.6435   53.2313   -6.8403
MFCC_12 -629.0443  -78.7796   -5.3665  ...   53.2313  128.5323    2.7658
MFCC_13 -145.9891  -67.3469  -42.5027  ...   -6.8403    2.7658  110.3785

[13 rows x 13 columns]

State 4 Covariance:
           MFCC_1    MFCC_2    MFCC_3  ...   MFCC_11   MFCC_12  MFCC_13
MFCC_1  3829.0884   44.0336 -570.5294  ... -206.1691 -346.7416 -49.2856
MFCC_2    44.0336  739.6548  263.1979  ...  -62.7582    1.6123 -61.6134
MFCC_3  -570.5294  263.1979  732.1710  ...    0.9868   21.1557 -44.4744
MFCC_4   570.5895   91.2564  -55.2070  ...  -22.7441  -44.7189 -26.8152
MFCC_5  -397.6961  398.9087   78.5433  ...    1.2479  101.5021 -80.6326
MFCC_6  -221.5277 -102.7305  106.4545  ...   65.9981   37.7890  17.5546
MFCC_7  -125.0036  138.8114   88.4080  ...  -57.8091   -1.6176  -3.0727
MFCC_8  -125.5394  -28.1195  -99.0389  ...  101.3300   40.9131 -26.0305
MFCC_9  -421.4110  -10.9483    9.5773  ...   45.4706   86.5884   1.3361
MFCC_10  -79.2907  -19.2023    4.4649  ...  -24.0332   -2.3289  61.0309
MFCC_11 -206.1691  -62.7582    0.9868  ...  116.7911   34.2616 -16.2983
MFCC_12 -346.7416    1.6123   21.1557  ...   34.2616  116.3985  -7.7781
MFCC_13  -49.2856  -61.6134  -44.4744  ...  -16.2983   -7.7781 116.7219

[13 rows x 13 columns]

State 5 Covariance:
           MFCC_1    MFCC_2    MFCC_3  ...   MFCC_11   MFCC_12   MFCC_13
MFCC_1  4359.9265 -122.6946 -853.7575  ... -169.0213 -385.4595  -32.4643
MFCC_2  -122.6946  898.3985  326.7694  ...  -80.8744   -1.5611 -115.4179
MFCC_3  -853.7575  326.7694  796.4185  ...   11.3024   40.3948  -65.0354
MFCC_4   711.7458   62.7021  -99.0407  ...  -33.2693  -76.9666  -31.5329
MFCC_5  -620.8051  464.4387  150.2332  ...  -26.6629   90.5841 -100.3535
MFCC_6  -315.8321 -260.5443   49.8278  ...   90.6000   66.3319   67.9040
MFCC_7  -138.8209  259.5013  130.7625  ...  -70.8733  -13.3190  -41.0768
MFCC_8   -78.5569  -67.9817 -106.3526  ...   90.7204   30.2055   -9.4760
MFCC_9  -522.4017  -42.6395   19.7716  ...   43.7110  107.0025   22.7759
MFCC_10  -74.0778   -2.6872    8.3970  ...  -21.8657    0.1138   52.8341
MFCC_11 -169.0213  -80.8744   11.3024  ...  110.6311   29.1707   -2.8067
MFCC_12 -385.4595   -1.5611   40.3948  ...   29.1707  124.6375    4.3096
MFCC_13  -32.4643 -115.4179  -65.0354  ...   -2.8067    4.3096  124.6835

[13 rows x 13 columns]

State 6 Covariance:
            MFCC_1    MFCC_2     MFCC_3  ...   MFCC_11   MFCC_12   MFCC_13
MFCC_1   7097.6672  442.9833 -1041.8126  ... -116.0797 -486.1214  -19.8439
MFCC_2    442.9833 1344.1551   392.1012  ... -124.0445  -61.6827 -201.6981
MFCC_3  -1041.8126  392.1012   798.9414  ...   -9.0424   36.0946  -99.2993
MFCC_4   1528.6213  200.1851  -108.6935  ...  -45.9280 -134.9061  -49.3058
MFCC_5   -880.3703  545.2483   259.4807  ...  -70.6655   51.8664 -138.4229
MFCC_6    -97.5026 -441.4133   -83.1973  ...  102.4185   68.6376  126.4332
MFCC_7   -266.8437  376.2575   195.4209  ...  -77.0235  -20.6304  -88.1510
MFCC_8     68.8656 -122.4067  -106.2539  ...   73.3860   15.1963   18.9244
MFCC_9   -690.4547 -141.6178   -11.2932  ...   40.2019  111.7464   51.6714
MFCC_10  -194.2026  -11.6066     4.9487  ...  -10.6403    9.2566   35.2699
MFCC_11  -116.0797 -124.0445    -9.0424  ...  103.3410   28.3817   20.2603
MFCC_12  -486.1214  -61.6827    36.0946  ...   28.3817  121.3424   23.9044
MFCC_13   -19.8439 -201.6981   -99.2993  ...   20.2603   23.9044  127.4594

[13 rows x 13 columns]

State 7 Covariance:
            MFCC_1    MFCC_2     MFCC_3  ...  MFCC_11   MFCC_12   MFCC_13
MFCC_1  14096.7090 2604.4520 -1258.4102  ...  55.1126 -630.4544  189.5008
MFCC_2   2604.4520 2014.9081   275.0151  ... -93.4984 -136.8229 -152.4703
MFCC_3  -1258.4102  275.0151   689.2693  ... -21.9233   42.1701  -96.6662
MFCC_4   3147.4035  569.9354  -176.5325  ...   1.3141 -160.9621   19.5197
MFCC_5  -1409.2442  331.1268   285.1368  ... -76.1605   45.6497 -131.4286
MFCC_6    765.5013 -245.7307  -149.8026  ...  74.7348    9.1538  116.6361
MFCC_7   -780.3478  205.4336   192.5013  ... -56.5861    9.1462  -85.9454
MFCC_8    447.6471  -72.8999   -88.6149  ...  51.5797   -9.0071   36.0589
MFCC_9   -685.3769 -159.8983   -13.2817  ...  15.1630   72.2621   32.7350
MFCC_10  -406.9747  -53.2101     8.0704  ...  -4.2709   14.8750    9.1580
MFCC_11    55.1126  -93.4984   -21.9233  ...  80.1473   16.9878   21.9341
MFCC_12  -630.4544 -136.8229    42.1701  ...  16.9878   94.5381   15.4286
MFCC_13   189.5008 -152.4703   -96.6662  ...  21.9341   15.4286   97.8731

[13 rows x 13 columns]

State 8 Covariance:
            MFCC_1    MFCC_2    MFCC_3  ...  MFCC_11   MFCC_12  MFCC_13
MFCC_1  17795.2448 5044.1023 -738.9823  ... 184.5791 -633.7358 393.2340
MFCC_2   5044.1023 2455.7373  141.2254  ...  -0.8985 -185.8652  22.3863
MFCC_3   -738.9823  141.2254  380.9417  ... -16.1597   26.4317 -49.0206
MFCC_4   3662.5469  950.2698 -119.6716  ...  45.6495 -135.3191  92.4380
MFCC_5  -1490.3246 -114.1025  160.8269  ... -41.0808   48.9978 -75.9548
MFCC_6   1356.4228  208.3412  -85.7058  ...  38.2284  -37.8501  67.6140
MFCC_7  -1126.3171 -169.1571   93.9982  ... -28.2998   33.8589 -51.5979
MFCC_8    640.8915   75.7796  -45.0712  ...  26.2662  -21.0487  30.7416
MFCC_9   -346.3032  -82.9624   -5.6468  ...  -0.7055   23.8741   4.6458
MFCC_10  -446.9609 -105.9125    3.9922  ...  -2.4049   14.0123  -7.8871
MFCC_11   184.5791   -0.8985  -16.1597  ...  39.3628    3.6215  10.9477
MFCC_12  -633.7358 -185.8652   26.4317  ...   3.6215   52.9998  -4.7012
MFCC_13   393.2340   22.3863  -49.0206  ...  10.9477   -4.7012  48.8409

[13 rows x 13 columns]
PASSED
tests/test_training.py::test_baum_welch 
Training `None` HMM using Baum-Welch algorithm...
Iteration 1, Log-Likelihood: -255891.70
Iteration 2, Log-Likelihood: -143444.14
Iteration 3, Log-Likelihood: -127369.77
Iteration 4, Log-Likelihood: -140514.92
Iteration 5, Log-Likelihood: -147176.45
Iteration 6, Log-Likelihood: -161325.52
Iteration 7, Log-Likelihood: -158641.91
Iteration 8, Log-Likelihood: -146780.65
Iteration 9, Log-Likelihood: -148727.49
Iteration 10, Log-Likelihood: -134762.24
Iteration 11, Log-Likelihood: -9991677.06
Iteration 12, Log-Likelihood: -147770.70
Iteration 13, Log-Likelihood: -129468.02
Iteration 14, Log-Likelihood: -inf
Iteration 15, Log-Likelihood: nan
Training complete!
PASSED

=============================== warnings summary ===============================
tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:192: RuntimeWarning: divide by zero encountered in log
    alpha[t - 1, 1] + np.log(self.A[1, 1]),

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:200: RuntimeWarning: divide by zero encountered in log
    alpha[t - 1, j] + np.log(self.A[j, j]),

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:229: RuntimeWarning: divide by zero encountered in log
    np.log(self.A[i, i])

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:238: RuntimeWarning: divide by zero encountered in log
    np.log(self.A[i, i])

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:254: RuntimeWarning: invalid value encountered in subtract
    log_gamma = log_gamma - log_norm

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:273: RuntimeWarning: invalid value encountered in scalar subtract
    alpha[t, 0]

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:293: RuntimeWarning: invalid value encountered in scalar subtract
    alpha[t, i]

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:302: RuntimeWarning: invalid value encountered in scalar subtract
    alpha[t, -2]

tests/test_training.py::test_baum_welch
  /Users/frankcholula/Workspace/school/sapr/assignment2/custom_hmm.py:311: RuntimeWarning: invalid value encountered in scalar subtract
    alpha[t, -1]

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
======================== 6 passed, 9 warnings in 5.93s =========================
